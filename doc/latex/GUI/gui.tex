% !TeX encoding = UTF-8
\chapter[Client]{Client}
\thispagestyle{fancy}
\label{client}

Die Beschreibung des Client bezieht sich im Folgenden nur auf die Applikation, welche Sprecher oder Zuhörer für die Präsentation zur Steuerung und Ansicht auf ihrem Endgerät benutzen. Client meint in diesem Zusammenhang nicht den vom Server gesteuerten Projektor.

\section[Grafische Benutzeroberfläche (GUI)]{Grafische Benutzeroberfläche (GUI)\footnote{Sascha Brexeler}}
\label{GUI}
Die Gestaltung dieser GUI bezweckt eine leicht verständliche, intuitiv bedienbare Oberfläche mit zielführender Benutzerführung und Hilfestellungen.
Die GUI ist für Geräte mit Android als Betriebssystem entwickelt, aber theoretisch nach dem kompilieren mit eventuell erforderlichen kleinen Anpassungen auch auf anderen Plattformen/Geräten ähnlich abgebildet und verwendbar. Erfolgreich getestet ist die App allerdings derzeit nur für Android (4.3 + 4.4) und Windows.


\begin{figure}[ht!]
	\centering
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/1-Startbildschirm.PNG}
	\end{minipage}
	%\hfill
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/1-0-1-Startbildschirm-PopUP-Team.PNG}
	\end{minipage}
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/1-0-1-Startbildschirm-PopUP-Hilfe.PNG}
	\end{minipage}
	\caption{v.l.n.r.: Startbildschirm, Über die App, Hilfemenü{\tiny}}
	\label{client:Appstart}
\end{figure}

\newpage

\paragraph{Start der App}$\;$\\
Von dem Startbildschirm aus besteht die Möglichkeit, ein Menü (siehe \autoref{client:OptionsMenue}) durch Klicken auf den aus drei Punkten bestehenden Menü-Button (siehe \autoref{client:Appstart}) aufzurufen.
\\In diesem lassen sich zwei Pop-Ups zur Hilfe und zum Team aufrufen (siehe \autoref{client:Appstart}).
\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.5]{GUI/Bilder/Info-Menu.PNG}
	\caption{Menü{\tiny}}
	\label{client:OptionsMenue}
\end{figure}
\paragraph{Verbindungsaufbau}$\;$\\
Des Weiteren kann der Benutzer nach Eingabe der gültigen IP-Adresse eine Verbindung zum Server als Zuhörer aufbauen. Die Eingabe der IP-Adresse erfolgt, wie in der dafür üblichen Notation, mit Punkttrennung. Eine Portangabe ist nicht nötig, da diese in Client und Server fest einprogrammiert ist.

\begin{figure}[ht!]
	\centering
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/2-Rollenwahl.PNG}
	\end{minipage}
	%\hfill
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/3-S-1-Voreinstellung.PNG}
	\end{minipage}
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/3-S-5-Voreinstellung.PNG}
	\end{minipage}
	\caption{v.l.n.r.: Rollenwahl, Voreinstellungen des Sprecher vor und nach Registrierung{\tiny}}
	\label{client:Rollenauswahl+S-Voreinstellungen}
\end{figure}

\newpage

\paragraph{Auswählen der eigenen Rolle}$\;$\\
Nach erfolgreichem Verbindungsaufbau wechselt die Ansicht in zur Rollenauswahl. Ein Label zeigt diese Position mittig der oberen Leiste (Toolbar) an (siehe \autoref{client:Rollenauswahl+S-Voreinstellungen}).
In dieser Toolbar befindet sich nun zusätzlich ein grüner nach links ausgerichteter Pfeil, um zur vorherigen Ansicht zu wechseln. Die Rollenwahl ist wiederholbar und somit korrigierbar, aber unumgänglich implementiert, da weitere Einstellung und Möglichkeiten auf dieser Entscheidung aufbauen.
\paragraph{Voreinstellungen als Sprecher}$\;$\\
Der Sprecher muss sich zunächst als solcher bei dem Server registrieren. Dazu ist eine Passwortabfrage eingerichtet. Das sog. Masterpasswort ist "`mpw12345"'. Wenn die Eingabe fehlerhaft erfolgte, erscheint zusätzlich unter dem Textfeld zur Passworteingabe (siehe \autoref{client:Rollenauswahl+S-Voreinstellungen}) in Dickschrift der Hinweis: "`Bitte überprüfen Sie Ihre Passworteingabe"'. Sobald die korrekter Eingabe bestätigt ist, kann der Benutzer eine Pdf-Datei hochladen. Dazu muss der Nutzer eine Pdf-Datei über den File-Dialog (siehe \autoref{client:FileDialog}) suchen und auswählen. Der Client sendet die Pdf nach dem Öffnen an den Server, der diese direkt auf Seite 0 über den Projektor ausgibt. Bevor der Sprecher mit Bestätigen zur Pdf-Ansicht wechselt, sieht dieser noch eine Liste (ListView) mit einigen Optionen, aus denen er die Gewünschten über Schiebeschalter (SwitchDelegates) auswählen kann. Mit dem grünen Pfeil wechselt die Ansicht diesmal zurück zur Rollenwahl.

\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.7]{GUI/Bilder/3-S-4-Voreinstellung.PNG}
	\caption{File-Dialog{\tiny}}
	\label{client:FileDialog}
\end{figure}

\newpage

\begin{figure}[ht!]
	\centering
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/7-H-Voreinstellungen.PNG}
	\end{minipage}
	%\hfill
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/4-S-PDF-Ansicht.PNG}
	\end{minipage}
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/6-Menu-Button-Drawer-mit-Listview.PNG}
	\end{minipage}
	\caption{v.l.n.r.: Voreinstellungen des Zuhörers, PdfAnsicht und Drawer{\tiny}}
	\label{client:H-VoreinstellungenPdfAnsichtDrawer}
\end{figure}

\paragraph{Voreinstellungen als Zuhörer}$\;$\\
Als Zuhörer sind die Voreinstellungen ähnlich, jedoch entfällt die Passworteingabe und das Herunterladen einer Pdf-Datei ersetzt den Vorgang des Hochladens (siehe \autoref{client:H-VoreinstellungenPdfAnsichtDrawer}). Hierbei erfolgt (ohne eine Auswahlmöglichkeit) das Herunterladen der zuletzt auf dem Server geladenen Datei.
\paragraph{Pdf-Ansicht}$\;$\\
Bestätigen der Voreinstellungen des Sprechers oder Zuhörers bedingt einen Kontextwechsel zur Pdf-Ansicht (siehe \autoref{client:H-VoreinstellungenPdfAnsichtDrawer}).
\paragraph{Drawer}$\;$\\
Mit dem Wechsel zur Pdf-Ansicht ist der grüne Pfeil oben links durch einen weiteren aus drei waagerechten Strichen bestehenden Menü-Button ersetzt. Dieser Button öffnet eine vertikale Leiste (Drawer) am linken Bildschirmrand, welche ein ListView beinhaltet. Dieses ListView ermöglicht schnelle Navigation zu allen bisherigen Ansichten und Weiteren (siehe \autoref{client:H-VoreinstellungenPdfAnsichtDrawer}). Durch Wischen vom linken Bildschirmrand nach rechts lässt sich dieser ebenfalls einblenden. Die Navigation über das ListView im Drawer ist nur möglich, solange man nicht zu vorherigen Ansichten wechselt.

\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.5]{GUI/Bilder/SchnellLeiste.PNG}
	\caption{Symbolleiste{\tiny}}
	\label{client:Symbolleiste}
\end{figure}

\paragraph{Symbolleiste}$\;$\\
Die Pdf-Ansicht beinhaltet eine Symbolleiste (siehe \autoref{client:Symbolleiste}) als Reihe von Icons am unteren Bildschirmrand. Mit ihr ist durch die Pfeile außen ein Blättern in der Pdf möglich. Intuitiv  kann der Benutzer durch Betätigen des linken Pfeils zurück blättern und mit dem Rechten vorwärts. Die anderen Buttons dienen zur Aktivierung/Deaktivierung von Bedienoptionen. Grün signalisiert hierbei den Status aktiviert und grau deaktiviert. Das Mikrofon steht für die Audiosteuerung, das Kamerasymbol für  Gestensteuerung und das Männchen mit den ausgestreckten Armen und Beinen im Kreis für die Kippsteurung. Neben diesem Symbol steht die Seitennummer der angezeigten Seite.
\\Die ineinander greifenden Pfeile signalisieren bei grün, dass die Autosynchronisation aktiv ist. Sobald diese nicht aktiv ist, erscheint ein weiterer Pfeil geschlungen im Uhrzeigersinn in grau auf der Symbolleiste links neben dem Pfeil. Die Funktion ist das manuelle Aktualisieren der Seitenzahl. Ein Sprecher sendet mit dem Refresh-Button die Seitenzahl, die auf seinem Device aktuell ist, zum Server, welcher sie an die Zuhörer-Clients weiterleitet. Ist als Sprecher der Status Autosynchronisation aktiviert, geschieht diese bei jedem Blättern automatisch. Zuhörer können über den Refresh-Button die aktuelle Seite manuell anfragen oder mit Autosynchronisation alle 2 Sekunden zu der aktuellen Seite zurück springen. Wenn der Sprecher blättert, erhalten die Zuhörer jedoch in jedem Fall die aktuelle Seite.

\paragraph{Informationen zur Benutzung}$\;$\\
Da das bisherige Hilfe-Pop-Up nur recht allgemeine Informationen enthält sowie für weitere Hilfestellung auf diese eventuell nicht zur Hand liegenden Dokumentation verweist, kann sich der Benutzer über den Drawer zu einer Erklärung der Bedienmöglichkeiten navigieren. Diese Option soll einen möglichst einfachen Einstieg ohne unnötiges Ausprobieren sicherstellen und Anwendungsfehler verhindern. Um einen mit dieser Anwendung vertrauten Anwender nicht nach jedem Start durch diese Informationen zu führen, ist das Aufrufen optional (siehe \autoref{client:InformationenBedienhilfen}).

\newpage
    

\begin{figure}[ht!]
	\centering
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/Klatschsteuerung.PNG}
	\end{minipage}
	%\hfill
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/Gestensteuerung.PNG}
	\end{minipage}
	\begin{minipage}{0.31\linewidth}
		\centering
		\includegraphics[scale=0.5]{GUI/Bilder/Kippsteuerung.PNG}
	\end{minipage}
	\caption[v.l.n.r.: Klatschsteuerung, Gestensteuerung und Kippsteuerung]{v.l.n.r.: Klatschsteuerung, Gestensteuerung und Kippsteuerung.\footnotemark}
	\label{client:InformationenBedienhilfen}
\end{figure}

\footnotetext{Text zur Kippsteuerung von Jens Helge Micke} 


\section[Serveranbindung]{Serveranbindung\footnote{Sascha Brexeler}}
\label{client-Serveranbindung}
Die Einbindung der Funktionsblöcke zur Kommunikation des Clients mit dem Server ist in Zusammenarbeit\footnote{zwischen Sascha Brexeler und René Beckmann} im Team entstanden. Details zur Kommunikation finden Sie in Kapitel \ref{server}.


\section[Software]{Software\footnote{Sascha Brexeler}}
\label{guiSoftware}
Die Software der GUI finden Sie im Git Repository \footnote{https://github.com/BeckmaR/EmbeddedMultimediaSS2016/tree/master/src/app\textunderscore gui}. Einige Funktionalitäten/Bibliotheken sind jedoch aus benachbarten Ordnern eingebunden.

\paragraph{Konzept}$\;$\\
Zur Umsetzung von GUI, Serveranbinung und der Einbindung der erweiterten Navigationsmöglichkeiten dient Qt-Creator 4.0.2 als IDE. Qt-Creator ist wegen seiner Plattformunabhängigkeit und der grafischen Beschreibungssprache qml für den Client besonders geeignet. Programmiert ist die GUI überwiegend mit qml. Eine Kombination mit C++ Funktionen sowie das Signal-Slot-Prinzip kommen dabei an vielen stellen z.B. der Serveranbindung zum Einsatz. Mit dem Design-Tool von Qt-Creator stand eine graphische Programmiermöglichkeit von qml-Code zur Verfügung. Dieses stellt eine interessante Ergänzung zum "`schriftlichen"' Programmieren dar. Nach einer erfolgreichen Erprobung des Tools habe ich mich zugunsten der Homogenität des Codes gegen dieses Tool entschieden.
\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.8]{GUI/Bilder/Projektordnerstruktur.PNG}
	\caption{Projektordnerstruktur {\tiny}}
	\label{client:Projektordnerstruktur}
\end{figure}


\paragraph{Struktur}$\;$\\
Der in Qt-Creator erstellte Projektordner app\textunderscore gui enthält die Projektdatei "`app\textunderscore gui.pro"', Header-Dateien, Quelldateien und Ressourcendateien (siehe \autoref{client:Projektordnerstruktur}). Unter den Quelldateien befindet sich das C++ Hauptprogramm "`main.cpp"'. Unter anderem instantiiert dieses beim Programmstart die Klasse QQmlApplicationEngine unter dem Namen "`engine"'. Im Anschluss daran öffnet die Methode engine.load(QUrl(QLatin1String("qrc:/main.qml"))) aus den Ressourcendateien das in qml geschriebene qml-Hauptprogramm "`main.qml"'. Die Datei qml.qrc verwaltet die Ressourcen. Dadurch ist es möglich, aus dem qml-Hauptprogramm weitere Ressourcendateien, z.B. in Form von Bildern oder weiteren, in qml programmierten grafischen und funktionalen Elementen darzustellen oder aufzurufen, wenn diese sich in den Ressourcendateien befinden. Graphische Elemente können Rechtecke, Buttons, oder ganze Menüleisten sein und funktionale Elemente z.B. Timer.
Das StackView beinhaltet den Inhalt, welcher außerhalb der Randelemente Drawer oder ToolBar auf dem Bildschirm zur Anzeige kommt. Im Hauptprogramm befindet sich im StackView die Startansicht. Bei weiterer Navigation durch die GUI ersetzen andere in qml geschriebene Dateien das StackView. Pop-ups überblenden es nur.
Für eine gute Übersicht über den Code bietet der Ct-Creator die Möglichkeit, Codebl\"ocke einzuklappen(siehe \autoref{client:codeausschnitt-main.qml}).

\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.8]{GUI/Bilder/qml-main-Codeausschnitt.PNG}
	\caption{Wesentliche eingeklappte Codebl\"ocke des qml-Hauptprogramms "`main.qml"' {\tiny}}
	\label{client:codeausschnitt-main.qml}
\end{figure}

\paragraph{Zustandssteuerung}$\;$\\
Die Realisierung der grafischen Oberflächen entsprechend bisheriger Einstellungen ist über Zustände einer Variablen "`appState"' realisiert. Entsprechend der aktuellen Zustände sind Informationen mittels der Objekteigenschaft "`visible"' ein- oder ausgeblendet oder über "`enable"' aktiviert oder deaktiviert. Außerdem gibt es weitere Variablen, die speichern, dass Einstellungen wie z.B. die automatische Synchronisation aktiviert sind, um vor dem Ausführen von Funktionen zu überprüfen, ob diese gewünscht sind.

\newpage

\section{Navigation}
\input{beatcontrol/beatcontrol}
\input{handcontrol/handcontrol}
\input{Beschleunigungssensor/Beschleunigungssensor}

\section[Features]{Features\footnote{Sascha Brexeler}}

Exemplarisch sind hier einige wichtige Features sind hier aufgelistet.

\paragraph{Ein Sprecher kann:}$\;$\\
- eine Pdf-Datei in der App von seinem Gerät öffnen und über einem Projektor ausgeben\\
- blättern in einer Pdf ohne dass ein Update auf dem Server erfolgt\\
- Seiten automatisch beim Blättern, oder manuell an den Server senden
\paragraph{Ein Zuhörer kann:}$\;$\\
- frei blättern in einer Pdf bis der Sprecher die Seite auf dem Server aktualisiert\\
- Einstellen, dass er nach 2 Sekunden wieder auf der aktuellen Seite ist
\paragraph{Sprecher und Zuhörer können:}$\;$\\
- Buttons, Wischgesten, Klopfgeräusche, oder Kippbewegungen zum Blättern nutzen\\
- die App auf Geräten mit unterschiedlichen Auflösungen und Displaygrößen verwenden\\
- auf vielen Seiten Scollen, wenn die nicht der gesamte auf den Display passt\\
- ohne viel Vorwissen die App bedienen, wenn ein Server mit bekannter IP-Adresse in Betrieb ist\\
- eine an die Displayausrichtung automatisch horizontal oder vertikal ausgerichtete Pdf betrachten
\section[Erweiterungspotential]{Erweiterungspotential\footnote{Sascha Brexeler}}

Einige mögliche Erweiterungen sind in diesem Abschnitt aufgelistet. Andere denkbare Verbesserungen sind in z.T. bei anderen Kapiteln aufgeführt. In Kapitel \ref{Ausblick} finden Möglichkeiten mit einer abgeänderte Applikation ganz neue Anwendungen zu erschlie\ss en.

\paragraph{Erweiterungen für den Zuhörer:}$\;$\\
- Einstellen der Zeit die vergehen soll bis sich die Applikation synchronisiert, wenn Autosynchronisation aktiviert ist

\paragraph{Erweiterungen für Sprecher und Zuhörer:}$\;$\\
- Zoomen in der Pdf \\
- Erkennung von Touchstgesten in der \\
- Audioeinstellungen (z.B. Kalibrieren des Schwellwertes von Schalldruckpegelen fürs Blättern)\\
- Kameraeinstellungen (z.B. Wahl zwischen Frontkamera und Hauptkamera)\\
- Wartesymbol/Beschäftigungsanzeige (in aktueller Version nicht erforderlich)\\
- Zeichnen/Markieren auf der Pdf und Mitschneiden von Tonaufnahmen\\
- Interaktion von Zuhörern mit dem Sprecher über Zuhöreranfragen